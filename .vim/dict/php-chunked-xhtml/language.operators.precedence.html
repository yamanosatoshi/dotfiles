<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>演算子の優先順位</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="language.operators.html">« 演算子</a></li>
      <li style="float: right;"><a href="language.operators.arithmetic.html">代数演算子 »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="language.operators.html">演算子</a></li>
    <li>演算子の優先順位</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="language.operators.precedence" class="sect1">
   <h2 class="title">演算子の優先順位</h2>
   <p class="para">
    演算子の優先順位は、二つの式が&quot;緊密に&quot;結合している度合いを指定します。
    例えば、式 <code class="literal">1 + 5 * 3</code> の答えは
    <code class="literal">16</code> になり、<code class="literal">18</code> とはなりません。
    これは乗算演算子(&quot;*&quot;)は、加算演算子(&quot;+&quot;)より高い優先順位を有するか
    らです。必要に応じて強制的に優先順位を設定するために括弧を使用する
    ことが可能です。例えば、<code class="literal">18</code>と評価するためには、
    <code class="literal">(1 + 5) * 3</code> とします。
   </p>
   <p class="para">
    演算子の優先順位が等しい場合は、その結合性によって評価順
    (右から評価するのか、あるいは左から評価するのか) が決まります。
    たとえば &quot;-&quot; は左結合なので、
    <code class="literal">1 - 2 - 3</code> は <code class="literal">(1 - 2) - 3</code> とグループ分けされて、
    評価結果は <code class="literal">-4</code> になります。
    一方、&quot;=&quot; は右結合です。つまり <code class="literal">$a = $b = $c</code> のグループ分けは
    <code class="literal">$a = ($b = $c)</code> となります。
   </p>
   <p class="para">
    優先順位が同じで結合しない演算子を並べることはできません。つまり、たとえば
    <code class="literal">1 &lt; 2 &gt; 1</code> は PHP では無効になります。
    一方 <code class="literal">1 &lt;= 1 == 1</code> は問題ありません。
    <code class="literal">==</code> 演算子の優先順位が
    <code class="literal">&lt;=</code> 演算子より低いからです。
   </p>
   <p class="para">
    演算子の結合は、
    二項演算子(および三項演算子) の場合にだけ意味があります。
    単項演算子は、前置または後置しかないため、
    演算子の結合の考え方は適用できません。
    たとえば、
    <code class="literal">!!$a</code> は、
    <code class="literal">!(!$a)</code> という形でのみグループ化できます。
   </p>
   <p class="para">
    厳密には不要な場所であっても、括弧をつけておけばコードの可読性があがります。
    明示的にグループ分けをしておくことで、演算子の優先順位や結合性による暗黙のグループ分けに頼らずに済むからです。
   </p>
   <p class="para">
    次の表では、優先順位が高い順に演算子を挙げています。
    同じ行にある演算子は優先順位が等しくなります。そのような場合は、
    結合時の評価にしたがってグループ分けが決まります。
    <table class="doctable table">
     <caption><strong>演算子の優先順位</strong></caption>
     
      <thead>
       <tr>
        <th>結合時の評価</th>
        <th>演算子</th>
        <th>追加情報</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td>(n/a)</td>
        <td>
         <code class="literal">clone</code>
         <code class="literal">new</code>
        </td>
        <td><a href="language.oop5.cloning.html" class="link">clone</a> および <a href="language.oop5.basic.html#language.oop5.basic.new" class="link">new</a></td>
       </tr>

       <tr>
        <td>right</td>
        <td><code class="literal">**</code></td>
        <td><a href="language.operators.arithmetic.html" class="link">代数演算子</a></td>
       </tr>

       <tr>
        <td>(n/a)</td>
        <td>
         <code class="literal">+</code> 
         <code class="literal">-</code> 
         <code class="literal">++</code> 
         <code class="literal">--</code> 
         <code class="literal">~</code> 
         <code class="literal">(int)</code> 
         <code class="literal">(float)</code> 
         <code class="literal">(string)</code> 
         <code class="literal">(array)</code>
         <code class="literal">(object)</code> 
         <code class="literal">(bool)</code> 
         <code class="literal">@</code>
        </td>
        <td>
         <a href="language.operators.arithmetic.html" class="link">代数演算子</a> (単項の <code class="literal">+</code> と <code class="literal">-</code>),
         <a href="language.operators.increment.html" class="link">加算子/減算子</a>,
         <a href="language.operators.bitwise.html" class="link">ビット演算子</a>,
         <a href="language.types.type-juggling.html#language.types.typecasting" class="link">型の相互変換</a> そして
         <a href="language.operators.errorcontrol.html" class="link">エラー制御演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">instanceof</code></td>
        <td>
         <a href="language.operators.type.html" class="link">型演算子</a>
        </td>
       </tr>

       <tr>
        <td>(n/a)</td>
        <td><code class="literal">!</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td>
         <code class="literal">*</code>
         <code class="literal">/</code>
         <code class="literal">%</code>
        </td>
        <td>
         <a href="language.operators.arithmetic.html" class="link">代数演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td>
         <code class="literal">+</code> 
         <code class="literal">-</code> 
         <code class="literal">.</code>
        </td>
        <td>
         <a href="language.operators.arithmetic.html" class="link">代数演算子</a> (単項の <code class="literal">+</code> と <code class="literal">-</code>),
         <a href="language.operators.array.html" class="link">配列演算子</a> そして
         <a href="language.operators.string.html" class="link">文字列演算子</a> (PHP 8.0.0 より前のバージョンの<code class="literal">.</code>)
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td>
         <code class="literal">&lt;&lt;</code> 
         <code class="literal">&gt;&gt;</code>
        </td>
        <td>
         <a href="language.operators.bitwise.html" class="link">ビット演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">.</code></td>
        <td>
         <a href="language.operators.string.html" class="link">文字列演算子</a> (PHP 8.0.0 以降)
        </td>
       </tr>

       <tr>
        <td>結合しない</td>
        <td>
         <code class="literal">&lt;</code> 
         <code class="literal">&lt;=</code> 
         <code class="literal">&gt;</code> 
         <code class="literal">&gt;=</code>
        </td>
        <td>
         <a href="language.operators.comparison.html" class="link">比較演算子</a>
        </td>
       </tr>

       <tr>
        <td>結合しない</td>
        <td>
         <code class="literal">==</code>
         <code class="literal">!=</code> 
         <code class="literal">===</code> 
         <code class="literal">!==</code> 
         <code class="literal">&lt;&gt;</code>
         <code class="literal">&lt;=&gt;</code>
        </td>
        <td>
         <a href="language.operators.comparison.html" class="link">比較演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">&amp;</code></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">ビット演算子</a> そして 
         <a href="language.references.html" class="link">リファレンス</a></td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">^</code></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">ビット演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">|</code></td>
        <td>
         <a href="language.operators.bitwise.html" class="link">ビット演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">&amp;&amp;</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">||</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

       <tr>
        <td>right</td>
        <td><code class="literal">??</code></td>
        <td>
         <a href="language.operators.comparison.html#language.operators.comparison.coalesce" class="link">NULL合体演算子</a>
        </td>
       </tr>

       <tr>
        <td>結合しない</td>
        <td><code class="literal">? :</code></td>
        <td>
         <a href="language.operators.comparison.html#language.operators.comparison.ternary" class="link">三項演算子</a>
         (PHP 8.0.0 より前のバージョンでは、左結合でした)
        </td>
       </tr>

       <tr>
        <td>right</td>
        <td>
         <code class="literal">=</code> 
         <code class="literal">+=</code> 
         <code class="literal">-=</code> 
         <code class="literal">*=</code> 
         <code class="literal">**=</code> 
         <code class="literal">/=</code> 
         <code class="literal">.=</code> 
         <code class="literal">%=</code> 
         <code class="literal">&amp;=</code> 
         <code class="literal">|=</code> 
         <code class="literal">^=</code> 
         <code class="literal">&lt;&lt;=</code> 
         <code class="literal">&gt;&gt;=</code>
         <code class="literal">??=</code>
        </td>
        <td>
         <a href="language.operators.assignment.html" class="link">代入演算子</a>
        </td>
       </tr>

       <tr>
        <td>(n/a)</td>
        <td><code class="literal">yield from</code></td>
        <td>
         <a href="language.generators.syntax.html#control-structures.yield.from" class="link">yield from</a>
        </td>
       </tr>

       <tr>
        <td>(n/a)</td>
        <td><code class="literal">yield</code></td>
        <td>
         <a href="language.generators.syntax.html#control-structures.yield" class="link">yield</a>
        </td>
       </tr>

       <tr>
        <td>(n/a)</td>
        <td><code class="literal">print</code></td>
        <td><span class="function"><a href="function.print.html" class="function">print</a></span></td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">and</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">xor</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

       <tr>
        <td>left</td>
        <td><code class="literal">or</code></td>
        <td>
         <a href="language.operators.logical.html" class="link">論理演算子</a>
        </td>
       </tr>

      </tbody>
     
    </table>

   </p>
   <p class="para">
    <div class="example" id="example-88">
     <p><strong>例1 結合時の評価</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">3&nbsp;</span><span style="color: #007700">*&nbsp;</span><span style="color: #0000BB">3&nbsp;</span><span style="color: #007700">%&nbsp;</span><span style="color: #0000BB">5</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;(3&nbsp;*&nbsp;3)&nbsp;%&nbsp;5&nbsp;=&nbsp;4<br />//&nbsp;PHP&nbsp;の三項演算子の結合法則は、C/C++のそれとは異なります<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">true&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">0&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">true&nbsp;</span><span style="color: #007700">?&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">:&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;PHP&nbsp;8.0.0&nbsp;より前のバージョンでは、(true&nbsp;?&nbsp;0&nbsp;:&nbsp;true)&nbsp;?&nbsp;1&nbsp;:&nbsp;2&nbsp;=&nbsp;2<br /><br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">2</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$b&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">3</span><span style="color: #007700">;&nbsp;</span><span style="color: #FF8000">//&nbsp;$a&nbsp;=&nbsp;($b&nbsp;+=&nbsp;3)&nbsp;-&gt;&nbsp;$a&nbsp;=&nbsp;5,&nbsp;$b&nbsp;=&nbsp;5<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
   </p>
   <p class="para">
    演算子の優先順位や結合性は、あくまでも式のグループ分けだけを決めるものであり、評価順を決めるものではありません。
    PHP では一般に、式をどの順番で評価するかは決めていません。
    そのため、特定の順序で式が評価されることを前提としたコードを書いてはいけません。
    PHP のバージョンが変わったり前後のコードが変わったりしたときに、評価順が変わる可能性があるからです。
    <div class="example" id="example-89">
     <p><strong>例2 評価順序は未定義</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />echo&nbsp;</span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">+&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">++;&nbsp;</span><span style="color: #FF8000">//&nbsp;2&nbsp;になるかもしれないし、3&nbsp;になるかもしれません<br /><br /></span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$array</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++;&nbsp;</span><span style="color: #FF8000">//&nbsp;インデックス&nbsp;1&nbsp;をセットするかもしれないし、インデックス&nbsp;2&nbsp;をセットするかもしれません<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

    </div>
    <div class="example" id="example-90">
     <p><strong>例3 <code class="literal">+</code>、<code class="literal">-</code>、<code class="literal">.</code> の優先順位は同じ(PHP 8.0.0 より前のバージョン)</strong></p>
     <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$x&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">4</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;次の行は、予期せぬ結果になることでしょう<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"x&nbsp;minus&nbsp;one&nbsp;equals&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">-</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">",&nbsp;or&nbsp;so&nbsp;I&nbsp;hope\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;なぜなら、これは次のように評価されるからです(PHP&nbsp;8.0.0より前のバージョン)<br /></span><span style="color: #007700">echo&nbsp;((</span><span style="color: #DD0000">"x&nbsp;minus&nbsp;one&nbsp;equals&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;-&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">",&nbsp;or&nbsp;so&nbsp;I&nbsp;hope\n"</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;期待どおりの結果を得るには、括弧を使って優先順位を指定します<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #DD0000">"x&nbsp;minus&nbsp;one&nbsp;equals&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;(</span><span style="color: #0000BB">$x</span><span style="color: #007700">-</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">",&nbsp;or&nbsp;so&nbsp;I&nbsp;hope\n"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
     </div>

     <div class="example-contents"><p>上の例の出力は以下となります。</p></div>
     <div class="example-contents screen">
<div class="cdata"><pre>
-1, or so I hope
-1, or so I hope
x minus one equals 3, or so I hope
</pre></div>
     </div>
    </div>
   </p>
   <blockquote class="note"><p><strong class="note">注意</strong>: 
    <p class="para">
     <code class="literal">=</code> は他のほとんどの演算子よりも優先順位が低いはずなのにもかかわらず、
     PHP は依然として <code class="literal">if (!$a = foo())</code>
     のような式も許します。この場合は <code class="literal">foo()</code> の返り値が
     <var class="varname">$a</var> に代入されます。
    </p>
   </p></blockquote>
   <div class="sect2">
    <h3 class="title">変更履歴</h3>
    <table class="doctable informaltable">
     
      <thead>
       <tr>
        <th>バージョン</th>
        <th>説明</th>
       </tr>

      </thead>

      <tbody class="tbody">
       <tr>
        <td>8.0.0</td>
        <td>
         文字列の連結 (<code class="literal">.</code>) 
         の優先順位は、
         代数演算子の加算/減算
         (<code class="literal">+</code> および <code class="literal">-</code>)
         と ビットシフト演算子
         (<code class="literal">&lt;&lt;</code> および <code class="literal">&gt;&gt;</code>);
         よりも低くなりました。
         これより前のバージョンでは、文字列の連結は
         <code class="literal">+</code> と <code class="literal">-</code>
         と同じ優先順位を持ち、
         <code class="literal">&lt;&lt;</code> と <code class="literal">&gt;&gt;</code>
         よりは高い優先順位を持っていました。
        </td>
       </tr>

       <tr>
        <td>8.0.0</td>
        <td>
         三項演算子 (<code class="literal">? :</code>) は、
         どの演算とも結合しなくなりました。
         これより前のバージョンでは、左結合でした。
        </td>
       </tr>

       <tr>
        <td>7.4.0</td>
        <td>
         三項演算子(<code class="literal">? :</code>) が左結合であることに依存すること、
         つまり、括弧で囲わずに三項演算子をネストすることは推奨されなくなりました。
        </td>
       </tr>

       <tr>
        <td>7.4.0</td>
        <td>
         文字列の連結 (<code class="literal">.</code>) 演算と、
         代数演算子の加算/減算
         (<code class="literal">+</code> および <code class="literal">-</code>)
         と ビットシフト演算子
         (<code class="literal">&lt;&lt;</code> および <code class="literal">&gt;&gt;</code>);
         の優先順位に依存するコードは、推奨されなくなりました。
         つまり、これらを括弧を使わずに一緒に使うことは推奨されなくなりました。
        </td>
       </tr>

      </tbody>
     
    </table>

   </div>
  </div></div></div></body></html>